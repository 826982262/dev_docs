version: "1.0"
## 参考 docker-compose.yaml 的编排方式，对自动化生成应用进行编排

## 数据连接定义，用于代码生成器连接
connection:
   driver: mysql
   host: 172.17.0.1:3306/cr
   username: root
   password: root
   
ui:
   ##  风格: 白天,黑夜,蓝天,草原,彩霞,浪漫
   theme: Light
   ## 菜单应用布局  
   menu-layout: 
   
login: 
   ## github,none
   sso: github
   ## 是否可注册, allow,none
   reg: none
   
## 服务模块定义
modules:
  module:
    description: 'API for Issues'
    tag: issue
    menu-group: 问题管理
    menu-title: 问题列表
    ## 定义CRUD 关系，单表 或 一对多 关系
    cg:    ## 由crud 改为 cg, 更能清楚指示为代码生成配置
      mask: master
      master: cr_issue
      master_id: issue_id
      slaves:
        - slave: cr_issue_note
    #   - slave: cr_another_table
    ## 关于 issue 的 API, 这里定义所有 CRUD 需要生成的api 
    api:
      crud:  ## 可标准化的 crud 不符合 /api/crud 报错
        path: /api/crud/issue/issues
        crud:
            - CREATE
            - UPDATE
            - RETRIEVE
            - DELETE
      status: 
         ## 状态是否是使用工作流去配置有多少个状态呢 ？
         enum:
             - UNDEFINED
             - OPEN
             - FIXED
             - NFP
             - NTF
             - DEPLICATE
             - NR
             - CLOSED
             - VERIFIED
             - DONE
          api: POST /api/crud/issue/issues/{id}
          
      ## 行动定义
      actions: 
         action:
           tag: assign
           ## 默认基于 crud.path POST /api/crud/issue/issues/{id}
           api: POST /api/crud/issue/issues/{id}
         action:
           tag: route
           api: POST /api/crud/issue/issues/{id}
           flow: status
           from: OPEN
           to: OPEN

          ## 只有 originator 才能 close, 特定的状态才能 closed 
          action:
            tag: close: 
            api: POST /api/crud/issue/issues/{id}
            flow: status
            from: FIXED/NFP/NTF/DEPLICATE/NR
            to: CLOSED
            
          action:
            tag: fixed
            api: POST /api/crud/issue/issues/{id}
            flow: status
            from: OPEN
            to: VERIFIED
        
           ## 未复现
          aciton:
            tag: nfp
            api: POST /api/crud/issue/issues/{id}
            flow: status            
            from: OPEN
            to: NFP
           
        ## 重复ISSUE
        aciton::
            tag: duplicate
            api: POST /api/crud/issue/issues/{id}
            flow: status
            from: OPEN
            to: DEPLICATE
        ## None Reproducable
        aciton:
            tag: nr
            api: POST /api/crud/issue/issues/{id}
            flow: status
            from: OPEN
            to: NR  
            
        aciton: 
          tag: done
          api: POST /api/crud/issue/issues/{id}
          flow: status
          from: OPEN
          to: DONE
          
